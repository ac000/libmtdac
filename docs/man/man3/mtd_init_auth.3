.\" Automatically generated by Pandoc 3.1.11.1
.\"
.TH "mtd_init_auth" "3" "May 7, 2025" "Version 0.90.0" "libmtdac"
.SH NAME
\f[B]mtd_init_auth\f[R] \- authorise with HMRC account
.SH LIBRARY
libmtdac, \f[I]\-lmtdac\f[R]
.SH SYNOPSIS
\f[B]#include <libmtdac/mtd.h>\f[R]
.PP
int mtd_init_auth(enum mtd_api_scope scope, unsigned long scopes);
.SH DESCRIPTION
This function is used to authorise the library with the users HMRC
account.
.PP
It will load the HMRC site in a new browser tab for the user to login
and then accept the specified access scopes.
.PP
It will prompt the user for the fBauthorisation codefP that is shown to
the user after completing the above step.
.PP
Once the user has entered the code it will create a
\f[B]\[ti]/.config/APP/libmtdac/{prod,test}\-api/oauth.json\f[R] file.
.TP
\f[B]scope\f[R]
is an enum value specifying which Make Tax Digital API this is adding
authorisations for and is one of the following values
.TP
\f[B]MTD_API_SCOPE_ITSA\f[R]
For Income TAX Self\-Assessment
.TP
\f[B]MTD_API_SCOPE_VAT\f[R]
For VAT
.PP
The above can optionally be bitwise \f[B]OR\f[R]\[aq]d with
.TP
\f[B]MTD_API_SCOPE_ADD\f[R]
Which says don\[aq]t reset the oauth.json file when writing it, instead
add this OAuth as another entry (or overwrite an existing entry without
resetting the file).
.TP
\f[B]scopes\f[R]
is a bitwise \f[B]OR\f[R] of one or more of the following
.TP
\f[B]MTD_SCOPE_RD_SA\f[R] & \f[B]MTD_SCOPE_WR_SA\f[R]
Scopes for reading and writing Self\-Assessment
.TP
\f[B]MTD_SCOPE_RD_VAT\f[R] & \f[B]MTD_SCOPE_WR_VAT\f[R]
Scopes for reading and writing VAT
.SH RETURN VALUE
On success, zero (\f[B]MTD_ERR_NONE\f[R]) is returned.
On error, one of the below errors is returned.
.SH ERRORS
.TP
\f[B]MTD_ERR_OS\f[R]
There was an OS level failure.
.TP
\f[B]MTD_ERR_UNKNOWN_SCOPES\f[R]
No scopes or one or more provided scopes were not recognised.
.TP
\f[B]MTD_ERR_REQUEST\f[R]
There was an error with the request.
.TP
\f[B]MTD_ERR_CONFIG_DIR_INVALID\f[R]
The supplied config directory is invalid.
.SH FILES
\[ti]/.config/APP/libmtdac/{prod,test}\-api/oauth.json
.SH SEE ALSO
\f[B]libmtdac(3)\f[R], \f[B]libmtdac_mtd.h(3)\f[R]
